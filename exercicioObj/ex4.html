<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../index.css" />
    <title>Exercício Votos Partidos</title>
  </head>

  <script>
    // Sistema de votação

    //Primeiro: Entrada de 10 candidatos (com código, partido, nome e qtdeVotos)
        //Partidos: PT, PL, PSDB e PDT
    //Segundo: Exiba o candidato mais votado (com nome e partido)
    //Terceiro: Exiba oi candidato mais votado do partido requisitado pelo usuário

    function calc() {
        let candidates = [];
        let partyOptions = ['PT', 'PL', 'PSDB', 'PDT'];
        let result = '';

        for(let i = 0; i < 4; i++)  {
            let candidate = {};
            candidate.name = prompt(`Digite o nome do ${i+1}º candidato:`);
            console.log(candidate.name);
            candidate.id = Number(prompt(`Digite o número de código do ${i+1}º candidato:`));
            console.log(candidate.id);
            candidate.party = prompt(`Digite o partido do ${i+1}º candidato: (PT / PL / PSDB / PDT)`);
            while(!partyOptions.includes(candidate.party.toUpperCase())) {
                alert('Digite um nome de partido válido!');
                candidate.party = prompt(`Digite o partido do ${i+1}º candidato: (PT / PL / PSDB / PDT)`);
            }
            candidate.votesQtt = Number(prompt(`Digite a quantidade de votos do ${i+1}º candidato:`));

            candidates.push(candidate);
        }

        let sortedCandidates = candidates.sort((candidateA, candidateB) => candidateA.votesQtt - candidateB.votesQtt)[candidates.length - 1];
        result += `O candidato mais votado de todos os partidos foi o ${sortedCandidates.name} com ${sortedCandidates.votesQtt} no partido ${sortedCandidates.party}`;

        let chosenParty = prompt('Digite um partido válido para a busca do candidato mais votado: (PT / PL /PSDB / PDT)');
        while(!partyOptions.includes(chosenParty.toUpperCase())) {
            alert('Digite um nome de partido válido!');
            let chosenParty = prompt('Digite um partido válido para a busca do candidato mais votado: (PT / PL /PSDB / PDT)');
        }

        let mostVotedCandidateParty = candidates.filter((candidate) => candidate.party === chosenParty).sort((candidateA, candidateB) => candidateA.votesQtt - candidateB.votesQtt)[candidates.length - 1];
        result += `\n\nO candidato mais votado do partido escolhido foi o ${mostVotedCandidateParty.name} com ${mostVotedCandidateParty.votesQtt} no partido ${mostVotedCandidateParty.party}`;

        document.getElementById('resultadoOp').innerHTML = result;
    }
  </script>
    
  <body>
    <h1>Exercício Filmes</h1>
    <div id="containerExercise">
      <button onclick="calc()">Calcular</button>
      <p id="resultadoOp"></p>
    </div>
  </body>
</html>